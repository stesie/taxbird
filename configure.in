dnl Process this file with autoconf to produce a configure script.

#AC_INIT(configure.in)
AC_INIT(taxbird, 0.1, [ssiegl@gmx.de])
AM_INIT_AUTOMAKE(taxbird, 0.1, [ssiegl@gmx.de])
AM_MAINTAINER_MODE
AM_CONFIG_HEADER(config.h)

AC_ISC_POSIX
AC_PROG_CC
AM_PROG_CC_STDC
AC_HEADER_STDC

pkg_modules="libgnomeui-2.0"
PKG_CHECK_MODULES(PACKAGE, [$pkg_modules])
AC_SUBST(PACKAGE_CFLAGS)
AC_SUBST(PACKAGE_LIBS)

GETTEXT_PACKAGE=taxbird
AC_SUBST(GETTEXT_PACKAGE)
AC_DEFINE_UNQUOTED(GETTEXT_PACKAGE,"$GETTEXT_PACKAGE", [Gettext package.])

dnl Add the languages which your application supports here.
ALL_LINGUAS="de"
AM_GLIB_GNU_GETTEXT

dnl Check for GNU Guile
#AC_CHECK_HEADER(guile/gh.h,, AC_MSG_ERROR([GNU Guile include files missing.]))
#AC_CHECK_LIB(guile, gh_define,, AC_MSG_ERROR([GNU Guile libraries missing.]))
GUILE_FLAGS
GUILE_MODULE_REQUIRED(ice-9 format)

dnl Check for mhash/gpgme (crypto support for vendor ids)
AM_PATH_GPGME(1.0.0,, AC_MSG_ERROR([libgpgme missing.]))
#AC_CHECK_HEADER(gpgme.h,, AC_MSG_ERROR([libgpgme header files missing.]))

AC_CHECK_LIB(mhash, MD5Init,, AC_MSG_ERROR([mhash library missing.]))
AC_CHECK_HEADER(mhash.h,, AC_MSG_ERROR([mhash.h include file missing.]))

# check for get_current_dir_name
AC_CHECK_FUNC([get_current_dir_name], 
	      [AC_DEFINE(_GNU_SOURCE, [], 
	                 [Define to 1 if system supports _GNU_SOURCE])
	       AC_DEFINE(HAVE_GET_CURRENT_DIR_NAME, 1,
	                 [Define to 1 if you have get_current_dir_name])],)

CFLAGS="$CFLAGS $GPGME_CFLAGS $GUILE_CFLAGS $GLIB_CFLAGS"
LDFLAGS="$LDFLAGS $GPGME_LIBS $GUILE_LDFLAGS $GLIB_LIBS"

AC_OUTPUT([
Makefile
src/Makefile
src/guile/Makefile
src/guile/autoload/Makefile
src/guile/signatures/Makefile
po/Makefile.in
])

